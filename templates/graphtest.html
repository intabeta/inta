<html>
<head>
<script type="text/javascript">
var canvas = document.getElementById("myCanvas");
var ctx;
var linkText="http://intabeta.com";
var X;
var Y;
var points=[[49.10006122146211, 52.92301567610073], [75.50158295047942, 38.7195276017976], [70.40573297205871, 42.53719974378905], [223.96005248614827, 271.804987831733], [217.84439560465208, 270.45535524749164], [224.56249276975777, 278.03877453692826], [219.97282578243957, 275.33804963357926], [218.8208562366679, 280.54022153058804], [214.67189290448974, 275.8547575346942], [23.962451590269062, 110.20993480959356], [30.816307196222056, 106.1148653166655], [27.906250333719083, 97.43193669252112], [31.077837011136733, 115.75238443341021], [35.647115937381884, 112.51038219131738], [94.18282913505132, 44.51844646338417], [20.657794400711033, 124.78673973262887], [19.528954365677354, 118.75993022107387], [14.381663248149257, 122.51537605745561], [15.831538253159385, 106.15658778858185], [12.057443368736658, 111.90279068573814], [9.643218016689131, 106.28618576937032], [82.17042656512912, 83.90807062441098], [77.94798129293602, 87.08611210640127], [78.98758597877887, 79.99405104319759], [72.94130556321986, 85.64972230616472], [73.68478697870201, 80.65274002481978], [51.117033441841755, 39.35720167973522], [54.10833045703476, 42.94115034514888], [47.52650489538123, 42.77941940000399], [53.275616133919634, 47.73433507494206], [17.12861419311413, 18.959545501425925], [22.882229723659908, 63.4415398768242], [10.613152906721796, 8.431599927406047], [17.030048834833103, 7.812948803315322], [26.85466371620082, 56.310609119618775], [29.030710254005456, 31.577386099981908], [32.93346610342312, 39.213567379908966], [60.20224915591401, 47.626645546047456], [79.75479870015177, 66.78561760373282], [85.28685869899165, 67.98221725419727], [7.811156425536407, 64.56206899395889], [38.58673837784802, 46.11566365432067], [13.156387936370676, 63.03994852932128], [37.87226340447177, 122.33542175311179], [9.739368226689614, 70.19825178708773], [35.0718415016581, 53.3980860925079], [15.178870910851833, 68.91449156211524], [39.24542202595712, 58.10694189510904], [42.23666008437876, 34.114801394576354], [38.62747984225725, 24.6406790765616], [44.95751024911572, 25.891563835461856], [40.82825511301655, 134.78551001726345], [47.59964147528546, 129.7267572179499], [42.08893633844827, 129.4897167508311], [29.17152945785226, 82.46956964823474], [31.129719373592483, 67.68508790243604], [48.49835501551989, 47.40936989132674], [74.73008070178479, 72.41904172854501], [65.0930771549209, 63.690111974000516], [64.3744574608981, 28.918420225535918], [70.60704879572684, 30.447409738966805], [95.76696423328451, 54.41920777197793], [82.51153403156994, 51.163367479769164], [63.74796822260255, 37.68640164048302], [5.647660942417033, 17.455757885441155], [23.772942209634614, 47.71252656027759], [18.717528374677457, 43.82972565209858], [28.043244029199744, 39.707114499109736], [33.28381876993843, 34.18751257131521], [25.48550302272818, 35.32136043306088], [71.58642797438738, 53.76462431343044], [76.714829492912, 59.365893184377306], [75.83515187628177, 50.502092251797706], [56.61946597979355, 143.9585097442963], [51.14045946187903, 147.8383293725514], [47.701040592995966, 137.0394797153191]];
var edges=[[41, 45, 10.0], [41, 47, 6.0], [45, 47, 4.0], [41, 48, 7.0], [31, 41, 9.0], [31, 34, 8.0], [41, 34, 9.0], [31, 41, 12.0], [31, 54, 8.0], [31, 55, 8.0], [41, 54, 12.0], [41, 55, 12.0], [54, 55, 8.0], [30, 33, 8.0], [30, 32, 5.0], [33, 32, 5.0], [37, 57, 8.0], [37, 58, 8.0], [57, 58, 8.0], [37, 59, 8.0], [37, 60, 8.0], [59, 60, 8.0], [61, 62, 9.0], [37, 63, 4.0], [30, 64, 5.0], [30, 41, 5.0], [41, 65, 4.0], [41, 66, 7.0], [65, 66, 5.0], [41, 36, 7.0], [41, 69, 5.0], [41, 67, 5.0], [41, 68, 5.0], [41, 35, 5.0], [36, 69, 4.0], [36, 67, 4.0], [36, 68, 4.0], [36, 35, 4.0], [69, 67, 2.0], [69, 68, 2.0], [69, 35, 2.0], [67, 68, 2.0], [67, 35, 2.0], [68, 35, 2.0], [72, 70, 2.0], [72, 71, 2.0], [72, 37, 2.0], [72, 62, 2.0], [70, 71, 2.0], [70, 37, 2.0], [70, 62, 2.0], [71, 37, 2.0], [71, 62, 2.0], [37, 62, 2.0], [73, 75, 8.0], [73, 74, 8.0], [75, 74, 8.0], [41, 37, 2.0], [41, 0, 2.0], [37, 0, 2.0], [37, 0, 10.0], [37, 41, 10.0], [37, 56, 10.0], [0, 41, 8.0], [0, 56, 8.0], [41, 56, 8.0], [37, 1, 9.0], [37, 2, 9.0], [1, 2, 8.0], [8, 3, 10.0], [8, 7, 10.0], [8, 4, 10.0], [8, 6, 10.0], [8, 5, 10.0], [3, 7, 8.0], [3, 4, 8.0], [3, 6, 8.0], [3, 5, 8.0], [7, 4, 8.0], [7, 6, 8.0], [7, 5, 8.0], [4, 6, 8.0], [4, 5, 8.0], [6, 5, 8.0], [10, 54, 2.0], [10, 9, 2.0], [10, 11, 2.0], [54, 9, 2.0], [54, 11, 2.0], [9, 11, 2.0], [10, 43, 2.0], [10, 9, 2.0], [10, 12, 2.0], [10, 13, 2.0], [43, 9, 2.0], [43, 12, 2.0], [43, 13, 2.0], [9, 12, 2.0], [9, 13, 2.0], [12, 13, 2.0], [62, 14, 2.0], [15, 16, 8.0], [15, 17, 8.0], [15, 9, 8.0], [16, 17, 8.0], [16, 9, 8.0], [17, 9, 8.0], [19, 18, 8.0], [19, 9, 8.0], [19, 20, 8.0], [18, 9, 8.0], [18, 20, 8.0], [9, 20, 8.0], [23, 57, 8.0], [23, 25, 8.0], [23, 24, 8.0], [23, 21, 8.0], [23, 22, 8.0], [57, 25, 8.0], [57, 24, 8.0], [57, 21, 8.0], [57, 22, 8.0], [25, 24, 8.0], [25, 21, 8.0], [25, 22, 8.0], [24, 21, 8.0], [24, 22, 8.0], [21, 22, 8.0], [41, 27, 5.0], [41, 26, 5.0], [41, 29, 5.0], [41, 37, 6.0], [41, 56, 5.0], [41, 28, 5.0], [27, 26, 8.0], [27, 29, 8.0], [27, 37, 9.0], [27, 56, 8.0], [27, 28, 8.0], [26, 29, 8.0], [26, 37, 9.0], [26, 56, 8.0], [26, 28, 8.0], [29, 37, 9.0], [29, 56, 8.0], [29, 28, 8.0], [37, 56, 9.0], [37, 28, 9.0], [56, 28, 8.0], [57, 39, 2.0], [57, 38, 2.0], [57, 71, 2.0], [39, 38, 2.0], [39, 71, 2.0], [38, 71, 2.0], [31, 44, 8.0], [31, 46, 8.0], [31, 42, 8.0], [31, 40, 8.0], [44, 46, 8.0], [44, 42, 8.0], [44, 40, 8.0], [46, 42, 8.0], [46, 40, 8.0], [42, 40, 8.0], [41, 49, 2.0], [41, 50, 2.0], [49, 50, 2.0], [43, 75, 8.0], [43, 53, 8.0], [43, 51, 8.0], [43, 52, 8.0], [75, 53, 8.0], [75, 51, 8.0], [75, 52, 8.0], [53, 51, 8.0], [53, 52, 8.0], [51, 52, 8.0], [8, 1, 10.0]];
var forces=points.map(function(p) { return [0,0]; });
var velocities=points.map(function(p) { return [0,0]; });
var rad = 3;
var inLink = false;
var link=0;
var drawpoints = points;
var selected = -1;
var oldpoint = [0,0];
var minx = 0;
var maxx = 0;
var miny = 0;
var maxy = 0;
var xrange = 0;
var yrange = 0;
var r = 0;
var damp = 17;

function min(array) {
    return Math.min.apply(null,array);
}
function max(array) {
    return Math.max.apply(null,array);
}

// draw the nodes and edges
function draw() {
  canvas = document.getElementById("myCanvas");
  // check if supported
  if(canvas.getContext) {
    if (selected >= -1) {
      minx = min(points.map(function(point) {return point[0];}));
      maxx = max(points.map(function(point) {return point[0];}));
      miny = min(points.map(function(point) {return point[1];}));
      maxy = max(points.map(function(point) {return point[1];}));
      minx -= 0.1*Math.abs(minx);
      maxx += 0.1*Math.abs(maxx);
      miny -= 0.1*Math.abs(miny);
      maxy += 0.1*Math.abs(maxy);
      xrange = maxx - minx;
      yrange = maxy - miny;
      r = Math.max(xrange,yrange);
    }
    drawpoints = points.map(function(point) { return [(point[0]-minx+0.5*(r-xrange))*300/r,(point[1]-miny+0.5*(r-yrange))*300/r]; });
    //console.log(xrange,yrange);

    ctx=canvas.getContext("2d");

    //clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    //draw edges
    
    for (i=0;i<edges.length;i++) {
      ctx.beginPath();
      ctx.strokeStyle='rgba(0,0,0,'+String(edges[i][2]/50)+')';
      X1=drawpoints[edges[i][0]][0];
      Y1=drawpoints[edges[i][0]][1];
      X2=drawpoints[edges[i][1]][0];
      Y2=drawpoints[edges[i][1]][1];
      ctx.moveTo(X1,Y1);
      ctx.lineTo(X2,Y2);
      ctx.stroke();
      ctx.closePath();
    }
    

    //draw the nodes
    ctx.fillStyle = "#9999ff";
    ctx.beginPath();
    for (i=0;i<points.length;i++) {
      X=drawpoints[i][0];
      Y=drawpoints[i][1];
      ctx.moveTo(X+rad,Y);
      if (i==link && selected != -1) {
        ctx.arc(X,Y,rad+1,0,Math.PI*2,true);
      } else {
        ctx.arc(X,Y,rad,0,Math.PI*2,true);
      }
    }
    ctx.fill();

    //add mouse listeners
    canvas.addEventListener("mousemove", on_mousemove, false);
    canvas.addEventListener("mousedown", on_down, false);
    canvas.addEventListener("mouseup", on_up, false);

  }
}

//check if the mouse is over the link and change cursor style
function on_mousemove (ev) {
  var x, y;

  // Get the mouse position relative to the canvas element.
  if (ev.layerX || ev.layerX == 0) { //for firefox
    x = ev.layerX;
    y = ev.layerY;
  }
  // x-=canvas.offsetLeft;
  // y-=canvas.offsetTop;
  if (selected != -1) {
    var dx = r*(x-oldpoint[0])/2000;
    var dy = r*(y-oldpoint[1])/2000;
    points[link][0] += dx;
    points[link][1] += dy;
    oldpoint[0] += dx;
    oldpoint[1] += dy;
    draw();
  }

  //is the mouse over the link?
  if (selected == -1) {
    document.body.style.cursor = "";
    inLink=false;
    for (i=0;i<drawpoints.length;i++) {
      X=drawpoints[i][0];
      Y=drawpoints[i][1];
      if (x >= (X - rad) && x <= (X + rad) && y<=(Y+rad) && y>= (Y-rad)){
          document.body.style.cursor = "pointer";
          inLink=true;
          link=i;
      }
    }
  }
  
}

function update() {
  for (i=0; i<points.length; i++) {
    var p = points[i];
    var v = velocities[i];
    var f = forces[i];
    if (selected == -1 || i != link) {
      v[0] += f[0]/100;
      v[1] += f[1]/100;
      p[0] += v[0];
      p[1] += v[1];
    }
    f[0] = -v[0]*damp; //resets forces and adds damping force
    f[1] = -v[1]*damp;
    var p1 = [0,0];
    for (j=0; j<points.length; j++) {
      if (j != i) {
        p1 = points[j];
        d=Math.pow(Math.pow(p[0]-p1[0],2) + Math.pow(p[1]-p1[1],2),1.5);
        f[0]+=300000*(p[0]-p1[0])/d;
        f[1]+=300000*(p[1]-p1[1])/d;
      }
    }
    forces[i] = f;
  }
  for (i=0; i<edges.length; i++) {
    var e = edges[i];
    var p = points[e[0]];
    var p1 = points[e[1]];
    var f = forces[e[0]];
    var f1 = forces[e[1]];
    var dx = p[0]-p1[0];
    var dy = p[1]-p1[1];
    var d = Math.pow(Math.pow(dx,2) + Math.pow(dy,2),0.5);
    var s = 0.8*(1-10/(e[2]*d));
    f[0] -= s*dx;
    f[1] -= s*dy;
    f1[0] += s*dx;
    f1[1] += s*dy;
    forces[e[0]] = f;
    forces[e[1]] = f1;
  }

  draw();
  setTimeout(update,1);
}

//if the link has been clicked, go to link
function on_click(e) {
  if (inLink)  {
    console.log(link);
  }
}

function on_down(e) {
  if (inLink) {
    selected = link;
    oldpoint = drawpoints[link];
    console.log(link);
  }
}

function on_up(e) {
  selected = -1;
  draw();
}
</script>
</head>
<body onload="draw(); update()">
<center>
<canvas id="myCanvas" width="300" height="300" style="border-style:solid;border-width:1px">Canvas not supported.</canvas>
</center>
</body>
</html>