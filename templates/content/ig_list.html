{% extends "content/base_content.html" %}
{% load humanize %}
{% load thumbnail %}
{% load content_extras %}

{% block extrahead %}
<script type="text/javascript">

//fetching selected values / checked values
function getSelectedFavs(){
    $("input[name='phpqa[]']").each(function() {
        if ($(this).attr('checked'))
        {
            // alert($(this).val());
            $('#favoritesform').append('<input type="hidden" name="entries" value="' + $(this).val() + '" />');
        }
    });
    $('#favoritesform').submit();
}

//fetching selected values / checked values
function getSelectedVals(){
    $("input[name='phpqa[]']").each(function() {
        if ($(this).attr('checked'))
        {
            // alert($(this).val());
            $('#emailform').append('<input type="hidden" name="entries" value="' + $(this).val() + '" />');
        }
    });
    $('#emailform').submit();
}



</script>
{% endblock %}

{% block content_title %}<h2>{{ ig.title }}</h2>

{% endblock %}


{% block side1 %}

          <div class="well sidebar-nav">
            <ul class="nav nav-list">



<li class="nav-header">List Options</li>
<li {% if method == 'votes' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/votes/"><i class="icon-ok"></i>By Votes</a></li>
<li {% if method == 'decay' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/decay/"><i class="icon-check"></i>By Relevancy</a></li>
<li {% if method == 'growth' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/growth/"><i class="icon-signal"></i>By Growth</a></li>
<li {% if method == 'favorites' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/favorites/"><i class="icon-star"></i>By Favorites</a></li>
<li {% if method == 'green' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/green/"><span class="badge badge-success"></span>&nbsp;New Posts</a></li>
<li {% if method == 'orange' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/orange/"><span class="badge badge-warning"></span>&nbsp;1-2 days old</a></li>
<li {% if method == 'red' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/red/"><span class="badge badge-important"></span>&nbsp;3-5 days old</a></li>
<li {% if method == 'black' %}class="active"{% endif %}><a href="/content/ig/{{ ig.slug }}/black/"><span class="badge badge-inverse"></span>&nbsp;A week+ old</a></li>

              <li class="nav-header">Inta: Know the best</li>
              <li><a href="/"><i class="icon-home"></i>Home</a></li>
              <li><a href="/content/ig/"><i class="icon-align-justify"></i>Interest Groups</a></li>
              
              
              
              
              <li><a href="/content/myig/"><i class="icon-list"></i>My Groups</a></li>
<li><a href="/favorites/"><i class="icon-star"></i>My Favorites</a></li>
              <li><a href="/content/submit/"><i class="icon-plus"></i>Submit Content</a></li>
              <li><a href="/howto/"><i class="icon-question-sign"></i>How To</a></li>
              <li><a href="/mission/"><i class="icon-bullhorn"></i>Mission</a></li>

              <li class="nav-header">With selected checkboxes</li>
              <li><a href="javascript:void();" onclick="getSelectedVals()"><i class="icon-envelope"></i>Email to a friend</a></li>
              <li><a href="javascript:void();" onclick="getSelectedFavs()"><i class="icon-star"></i>Save in favorites</a></li>
              
            {% comment %}
            <li>
              <button type="submit" class="btn btn-primary"><i class="icon-envelope icon-white"></i> Email to a friend</button>
              </li>
              <br
              <li>
              <button type="submit" class="btn btn-primary"><i class="icon-star icon-white"></i>Save in favorites</button>
             
             </li>
             {% endcomment %}  
            
            </ul>
          </div><!--/.well -->
<div>
<form id="emailform" action="/email/" method="post">
{% csrf_token %}

</form>
<form id="favoritesform" action="/favorites/" method="post">
{% csrf_token %}

</form>
</div>


{% endblock %}



{% block content %}

<table class="table table-striped">
<tbody>
{% if posts %}
{% for post in posts %}
<tr>
<td>

<a href="http://{{ post.domain }}" target="_blank" >
<img style="max-width: 100%; min-width: 25%;" src="{{ MEDIA_URL }}{{ post.logo|default:"site_logos/default.png" }}" width="100" title="{{ post.domain }}" alt="{{ post.title }}" />
</a>
    
</td>
<td>

{% if method == 'votes' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}
{% if method == 'growth' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.last_growth|floatformat }}%</span>&nbsp;
<span class="badge {{ post.date_added|bubble_color }}">{{ post.decayed_score|floatformat }}</span>&nbsp;

{% endif %}
{% if method == 'decay' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.decayed_score|floatformat }}</span>&nbsp;
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}

{% if method == 'favorites' %}
<span class="badge {{ post.date_added|bubble_color }}">* {{ post.favorites }}</span>&nbsp;
{% endif %}

{% if method == 'green' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}
{% if method == 'orange' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}
{% if method == 'red' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}
{% if method == 'black' %}
<span class="badge {{ post.date_added|bubble_color }}">{{ post.ranking }}</span>&nbsp;
{% endif %}


<a href="{{ post.url }}" onClick="_gaq.push(['_trackEvent', 'Content', 'Link', '{{ post.title }}']);" class="main-link" target="_blank">{{ post.title }}</a>
&nbsp;{{ post.date_added|date:"M j" }}

<br />
{{ post.summary|default_if_none:"No summary available." }}...           
        
        
        
        {% comment %}
&nbsp;
        <a  data-toggle="collapse" href="#intro-{{ forloop.counter }}">
        <i class="icon-chevron-down"></i>
        </a>       
        
<br />
    Submitted {% comment %}by <a href="/accounts/{{ post.submitted_by }}/">{{ post.submitted_by }}</a>, {{ post.date_added|naturaltime }}, from <a href="http://{{ post.domain }}" target="_blank">{{ post.domain }}</a>.     
    {% endcomment %}





<div style="margin-top: 6px;"> 

{% if user.id %}
    Vote
    <form action="" method="post" class="button-form">
    {% csrf_token %}
        <input type="hidden" name="post_slug" value="{{ post.slug }}" />
        <input type="hidden" name="action" value="vote" />
        <button class="btn btn-mini const-width {% if post.slug in voter %}btn-success{% endif %}" {% if post.slug in voter or post.slug in double_voter %}disabled="disabled"{% endif %} type="submit">
        1
            
        </button>
    </form> 
    <form action="" method="post" class="button-form">
    {% csrf_token %}
        <input type="hidden" name="post_slug" value="{{ post.slug }}" />
        <input type="hidden" name="action" value="double_vote" />
        <button class="btn btn-mini const-width {% if post.slug in double_voter %}btn-success{% endif %}" {% if post.slug in voter or post.slug in double_voter %}disabled="disabled"{% endif %} type="submit">
        2
            
        </button>
        &nbsp;
       Select <input name="phpqa[]" type="checkbox" value="{{ post.slug }}">
    
   </form>
       
{% endif %}

{% comment %}
{{ post.summary|default_if_none:"No summary available." }}...   
<br />
   </form>       
        
    
    <form action="" method="post" class="button-form">
    {% csrf_token %}
        <input type="hidden" name="ig_slug" value="{{ ig.slug }}" />
        <input type="hidden" name="action" value="{% if ig.title in member %}leave{% else %}join{% endif %}" />
        <button class="btn btn-mini const-width" type="submit">
        <i class="icon-heart"></i>
        </button>
    </form> 
    <form action="" method="post" class="button-form">
    {% csrf_token %}
        <input type="hidden" name="ig_slug" value="{{ ig.slug }}" />
        <input type="hidden" name="action" value="{% if ig.title in member %}leave{% else %}join{% endif %}" />
        <button class="btn btn-mini const-width" type="submit">
        <i class="icon-envelope"></i>
        </button>
    </form>
        {% endcomment %}
</div>
</td>

</tr>
{% endfor %}
{% else %}
<tr><td>There are no entries that match your search criteria</td></tr>
{% endif %}
</tbody>
</table>
<hr />
<p>
Tell us your other <a href="/content/ig_proposal/">interests</a>! We'll use your recommendations as we expand.
</p>
{% endblock %}


{% block side3 %}
{% endblock %}

{% block extrascript %}
<script>
    !function ($) {
        //caching all the "tr" objects so that gain a better performance.

        var $tableRows = $('table>tbody>tr');
        //hide all the all the select & vote lines
        $tableRows.find("td>div").css('visibility','hidden');
        $(function () {
            $tableRows.hover(function () {
                //when mouse is on, animate it via 'fadeout'
                $(this).find("td>div").css({opacity: 0.0, visibility: "visible"}).animate({opacity: 1.0},500);
            }, function () {
                //by the same token, fade it out when mouse is out.
                $(this).find("td>div").css({opacity: 1.0, visibility: "hidden"}).animate({opacity: 0.0},500);
            });
        });
    }(window.jQuery);

</script>
{% endblock %}
